---

title: Vulcan RWD IG


keywords: fastai
sidebar: home_sidebar

summary: "Retreiver implementation of the RWD IG http://build.fhir.org/ig/HL7/vulcan-rwd/."
description: "Retreiver implementation of the RWD IG http://build.fhir.org/ig/HL7/vulcan-rwd/."
nb_path: "index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Quick-project-overview">Quick project overview<a class="anchor-link" href="#Quick-project-overview"> </a></h2><ul>
<li><code>10_main.ipynb</code><ul>
<li>TODO</li>
</ul>
</li>
<li><code>00_core.ipynb</code><ul>
<li>TODO</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="chat-with-sergey">chat with sergey<a class="anchor-link" href="#chat-with-sergey"> </a></h2><ul>
<li>need to think about real life posibility of using FHIR to build cohorts<ul>
<li>need to be careful that we don't get sucked into spending all our time on feasibility</li>
</ul>
</li>
<li>we have patient ID and we know which hospital etc it came from - prove capability by pulling data for specified patients<ul>
<li>FHIR middle layer (trinetex, ehr vendors etc) will enable cohort building etc</li>
<li>make sure we have all of the FHIR domains - to prove that FHIR is doing a good job as a transport service<ul>
<li>for SDTM submission / typical FDA sponsor study</li>
</ul>
</li>
</ul>
</li>
<li>secondary is what are we using this data for?</li>
<li>ID management<ul>
<li>IP address of EHR data provider - now go get the data<ul>
<li>you can't find patient unless someone also gives you patient ID</li>
<li>if we have study ID, some kind of recruitment service could resolve study ID to patients</li>
</ul>
</li>
</ul>
</li>
<li>use case for IPS is when someone is travelling abroad, IPS gives relevant clinical details to help treatment<ul>
<li>how do we pull IPS by patient ID?</li>
<li>might be built around current - not full history that we need for research</li>
<li>how much do we need to extend IPS?<ul>
<li>might we need an option to use non-IPS? possibly based on US core</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="bring-back">bring back<a class="anchor-link" href="#bring-back"> </a></h2><p>how can sd tech build a fhir server of our own ...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Running-locally">Running locally<a class="anchor-link" href="#Running-locally"> </a></h1><p>Note: See conda setup below</p>
<p>The easiest way to get started is to run the app from the command line.</p>
<pre><code>SET X_API_KEYS=['test']
conda activate vulcan_rwd_ig
cd github\pete88b\vulcan_rwd_ig
uvicorn app:app --reload
</code></pre>
<p>Hit <a href="http://127.0.0.1:8000/docs">the docs page</a> or <a href="http://127.0.0.1:8000/static/index.html">the index page</a> and try it out</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Deployment">Deployment<a class="anchor-link" href="#Deployment"> </a></h1><p>The app is currently available at; https://vulcan-rwd-ig.azurewebsites.net</p>
<ul>
<li>https://vulcan-rwd-ig.azurewebsites.net/docs</li>
<li>https://vulcan-rwd-ig.azurewebsites.net/static/index.html</li>
</ul>
<p>See https://fastapi.tiangolo.com/deployment/server-workers/ if you're interested in startup command options.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Deploy-with-az-webapp-up-(using-powershell)">Deploy with <code>az webapp up</code> (using powershell)<a class="anchor-link" href="#Deploy-with-az-webapp-up-(using-powershell)"> </a></h2><p>This kind of az deploy needs;</p>
<ul>
<li><code>requirements.txt</code> lists required packages <a href="https://docs.microsoft.com/en-us/azure/app-service/configure-language-python">see App Service docs</a></li>
<li><code>app.py</code> to create the FastAPI app.</li>
</ul>
<p>Note: If you change anything in requirements.txt, you'll probably have to delete the app service and recreate with <code>az webapp up</code>.</p>
<p><code>.azure/config</code> provides config details for deploying via the az command line tool (we don't push this file to github).</p>
<h3 id="az-command-setup"><code>az</code> command setup<a class="anchor-link" href="#az-command-setup"> </a></h3><p>I installed the azure cli via msi: https://docs.microsoft.com/en-us/cli/azure/install-azure-cli-windows?tabs=azure-cli</p>
<h3 id="Login">Login<a class="anchor-link" href="#Login"> </a></h3><p><code>az login</code></p>
<h3 id="Set-your-default-subscription">Set your default subscription<a class="anchor-link" href="#Set-your-default-subscription"> </a></h3><p>you might already have this as your default - see: <code>az account list</code></p>
<p><code>az account set --name ???</code></p>
<h3 id="deply-the-app">deply the app<a class="anchor-link" href="#deply-the-app"> </a></h3><p><code>az webapp up</code></p>
<h3 id="Configure-the-startup-command">Configure the startup command<a class="anchor-link" href="#Configure-the-startup-command"> </a></h3><p>In the azure portal;</p>
<ul>
<li>select the app service</li>
<li>Configuration</li>
<li>General settings</li>
<li>Startup command<ul>
<li>set to <code>gunicorn app:app --workers 4 --worker-class uvicorn.workers.UvicornWorker --bind 0.0.0.0</code></li>
</ul>
</li>
</ul>
<h3 id="turn-on-logging---this-is-a-good-idea-after-creating-the-app-service">turn on logging - this is a good idea after creating the app service<a class="anchor-link" href="#turn-on-logging---this-is-a-good-idea-after-creating-the-app-service"> </a></h3><p><code>az webapp log config --docker-container-logging filesystem</code></p>
<h3 id="check-logs">check logs<a class="anchor-link" href="#check-logs"> </a></h3><p><code>az webapp log tail</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Developers">Developers<a class="anchor-link" href="#Developers"> </a></h1><h2 id="Conda-set-up">Conda set-up<a class="anchor-link" href="#Conda-set-up"> </a></h2><p><code>conda env create -f environment.yaml</code></p>

</div>
</div>
</div>
</div>


